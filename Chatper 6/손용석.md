# 메세지와 인터페이스

훌륭한 객체지향 코드를 얻기 위해서는 클래스가 아니라 객체를 지향해야한다.

객체가 수행하는 책임에 초점을 맞춰야한다.

|특징|객체|클래스|
|---|---|---|
|개념|실 세계의 개념을 추상화한 것|객체를 생성하기 위한 설계도|
|존재|메모리에 할당되어 실행 중인 것|코드 형태로 존재|
|속성|객체가 가지고 있는 데이터|객체가 가지고 있는 데이터의 정의|
|기능|객체가 수행할 수 있는 작업|객체가 수행할 수 있는 작업의 정의|

```
객체와 클래스의 관계를 다음과 같은 예를 들어 설명하면 다음과 같습니다.

사람은 객체입니다. 
    사람에게는 이름, 나이, 성별 등의 속성이 있고, 말하기, 걷기, 먹기 등의 기능을 가지고 있습니다.



사람은 클래스입니다. 
    사람 클래스는 이름, 나이, 성별 등의 속성의 정의와 말하기, 걷기, 먹기 등의 기능의 정의가 포함되어 있습니다.
```
## 협력과 메세지

### 클라이언트-서버 모델
두 객체 사이의 협력 관계를 설명하기 위해 사용하는 전통적인 메타포

클라이언트 : 메세지를 전송하는 객체
서버 : 메세지를 수신하는 객체

### 용어 정리
- 메시지 : 객체들이 협력하기 위해 사용할 수 있는 유일할 의사소통 수단
  - 메시지 전송, 메시지 패싱 : 한 객체가 다른 객체에게 도움을 요청하는 것
  - 메시지 전송자 : 메시지를 전송하는 객체
  - 메시지 수신사 : 메시지를 수신하는 객체

  - 메시지의 형태
    - 수신자.오퍼레이션.인자
    - condition.isSatisfiedBy(screening)
- 메서드 : 메시지를 수신했을 때 실제로 실행되는 함수 또는 프로시저
  - 코드 상에서 동일한 이름의 변수에게 동일한 메시지를 전송하더라도 객체의 타입에 따라 실행되는 메서드가 달라질 수 있다는 것.

- 퍼블릭 인터페이스 : 객체가 의사소통을 위해 외부에 공갱하는 메시지의 집합
  - 오퍼레이션 : 프로그래밍 언어의 관점에서 퍼블릭 인터페이스에 포함된 메시지
    - 수행 가능한 어떤 행동에 대한 추상화를 의미한다.

- 시그니처 : 오퍼레이션(또는 메서드)의 이름과 파라미터 목록을 합쳐 부르는 것.

## 인터페이스와 설계 품질
1. 디미터 법칙
2. 묻지 말고 시켜라
3. 의도를 드러내는 인터페이스
4. 명령-쿼리 분리

### 디미터 법칙
객체의 내부 구조에 강하게 결합되지 않도록 협력 경로를 제한하라.

**특정한 조건을 만족하는 대상에게만 메시지를 전송하도록 프로그래밍해야한다**
- this 객체
- 메서드의 매개변수
- this의 속성
- this의 속성인 컬렉션의 요소
- 메서드 내에서 생성된 지역 객체

**기차충돌**
- screening.getMovie().getDiscountConditions();
  - 클래스의 내부 구현이 외부로 노출됐을 때 나타나는 전형적인 형태
    - 메시지 전송자는 메시지 수신자의 내부 정보를 자세히 알게 된다.
    - 수신자의 캡슐화는 무너지고, 전송자가 메시지 수진사자의 내부 구현에 강하게 결합된다.

```
Q. Design Patter 중 하나인 Builder 패턴에서 기차충돌 형태가 나타난다. 이는 괜찮은건가?
A. this 객체에 한해서 동작하기 때문에 디미터 법칙을 어겼다고 볼 수 없을 것 같다.
```
### 묻지말고 시켜라
메시지 전송자는 메시지 수신자의 상태를 기반으로 결정을 내린 후 메시지 수신자의 상태를 바
꿔서는 안된다.

내부 상태를 이용해 어떤 결정을 내리는 로직이 객체 외부에 존재한다면, 객체가 책임져야하는 어떤 행동이 객체 외부로 누수된 것이다.


### 의도를 드러내는 인터페이스
메서드를 명명하는 방법
1. 메서드가 작업을 어떻게 수행하는지를 나타내도록 이름을 짓는다.
2. '무엇'을 하는지 드러내라

### 인터페이스에 의도를 드러내자
오퍼레이션에 이름을 짓는 방법
- 협력이라는 문맥을 반영해야한다.
  - 클라이언트가 객체에게 `무엇`을 원하는지를 표현해야한다.

## 원칙의 함정
원칙이 현재 상황에 부적합하다고 판단된다면 과감하게 원칙을 무시하라

### 디미터 법칙은 하나의 도트(.)를 강제하는 규칙이 아니다.
결합도와 관련된 것이며, 이 결합도가 문제가 되는 것은 객체의 내부 구조가 외부로 노출되는 경우로 한정된다.

## 명령-쿼리 분리 원칙
- 루틴 : 어떤 절차를 묶어 호출 가능하도록 이름을 부여한 기능 모듈
  - 프로시저 : 부수효과를 발생시킬 수 있지만 값을 반화할 수 없다
  - 함수 : 값을 반환할 수 있지만 부수 효과를 발생시킬 수 없다.

* 부수효과 : 함수 내에서 어떤 구현이 함수 외부에 영향을 끼치는 경우 (side effect)

상태를 조회하는 함수와 객체의 내부의 값을 변경시키는 함수는 분리하여 호출해야한다.

-> 직관적으로 코드를 구성하고, 책임을 분리하자

